import os
import sys
import csv
import time
import traceback
from os.path import abspath, join, dirname
sys.path.insert(0, join(abspath(dirname(__file__)), '../../'))
# sys.stdout = io.TextIOWrapper(sys.stdout.buffer,encoding='utf8')

import models.plugins.batch as Batch
import application as app
import random

class main(Batch.main):

    def clean(self, smonth, emonth, logId = -1, force=False):
        if logId == -1:
            status, process = self.cleaner.get_status('clean')
            if force == False and status not in ['error', 'completed', '']:
                raise Exception('clean {} {}%'.format(status, process))
                return

            logId = self.cleaner.add_log('clean', 'process ...')
            try:
                self.clean(smonth, emonth, logId=logId)
            except Exception as e:
                error_msg = traceback.format_exc()
                self.cleaner.set_log(logId, {'status':'error', 'msg':error_msg})
                raise e
            return

        aname, atbl = self.get_a_tbl()
        cname, ctbl = self.get_c_tbl()
        cdba = self.cleaner.get_db(cname)

        acols = self.cleaner.get_cols(atbl, cdba)
        ccols = self.cleaner.get_cols(ctbl, cdba, ['created'])

        cols, f_cols = [], []
        for col in ccols:
            cols.append(col)
            if col not in acols and col not in ('sp1'):
                col = self.cleaner.safe_insert(ccols[col], '', insert_mod=True)
                f_cols.append(col)
            else:
                f_cols.append(col)

        sql = 'DROP TABLE IF EXISTS {}_tmp'.format(ctbl)
        cdba.execute(sql)

        sql = 'CREATE TABLE {t}_tmp AS {t}'.format(t=ctbl)
        cdba.execute(sql)

        cids, vals = [], []
        with open(os.path.dirname(__file__)+'/b149_clean.cfg.csv', 'r', encoding = 'gbk', ) as f:
            reader = csv.reader(f)
            data = [row for row in reader]
            frow = data[0]
            data = data[1:]

            cids, vals = [], []
            for v in data:
                source = v[frow.index('source')]
                cid = v[frow.index('cid')]
                sp1 = v[frow.index('sub_batch_name')]
                snum = ['tb','tmall','jd'].index(source)

                cids.append('\'{}-{}\''.format(snum, cid))
                vals.append('\'{}\''.format(sp1))

        sql = '''
            INSERT INTO {}_tmp ({})
            WITH IF(`source`=1 AND (shop_type < 20 and shop_type > 10 ), 0, `source`) AS snum,
                 transform(concat(toString(snum), '-', toString(cid)), [{}], [{}], '其它') AS sp1_x,
                 IF((snum, cid) IN ((1, 50011977), (2, 1389)), IF(multiSearchAny(name, ['磨砂']),'Face scrub','Cleansing'), sp1_x) AS sp1
            SELECT {} FROM {t} WHERE {w} AND uuid2 NOT IN (SELECT uuid2 FROM {t} WHERE {w} AND sign = -1)
        '''.format(ctbl, ','.join(cols), ','.join(cids), ','.join(vals), ','.join(f_cols), t=atbl, w='pkey>=\'{}\' AND pkey<\'{}\''.format(smonth, emonth))
        cdba.execute(sql)

        # replace
        sql = 'SELECT source, pkey FROM {}_tmp GROUP BY source, pkey'.format(ctbl)
        ret = cdba.query_all(sql)

        for source, pkey, in ret:
            sql = 'ALTER TABLE {t} REPLACE PARTITION ({},\'{}\') FROM {t}_tmp'.format(source, pkey, t=ctbl)
            cdba.execute(sql)

        sql = 'DROP TABLE {}_tmp'.format(ctbl)
        cdba.execute(sql)

        self.cleaner.add_log('clean', 'completed', '', process=100, logId=logId)


    def brush(self, smonth, emonth):
        clean_flag = self.cleaner.last_clean_flag() + 1
        tmall_ids = ','.join(['\'{}\''.format(v) for v in self.item_ids()[0]])
        jd_ids = ','.join(['\'{}\''.format(v) for v in self.item_ids()[1]])
        wheres = ['source = 1 and (shop_type > 20 or shop_type < 10 ) and item_id in ({})'.format(tmall_ids),
                  'source = 2 and item_id in ({})'.format(jd_ids)]

        for where in wheres:
            uuids1 = []
            ret, sales_by_uuid1 = self.cleaner.process_top_anew(smonth, emonth, where=where)
            # sales_by_uuids.update(sales_by_uuid1)
            for uuid2, source, tb_item_id, p1, cid, alias_all_bid in ret:
                if self.skip_brush(source, tb_item_id, p1):
                    continue
                uuids1.append(uuid2)
            print(sales_by_uuid1)
            self.cleaner.add_brush(uuids1, clean_flag, 1, sales_by_uuid=sales_by_uuid1)
        return True

    def item_ids(self):
        tmall = ['38848279045','12669264079','597585118157','539339147058','576644195365','16989611811','545378712840','539379501045','521402561924','603941978639','566446518116','526498885740','538766297543','23480436763','521058998247','582615005836','612290391218','587561704312','601009111088','44025627640','619244244508','529201426325','545473839106','613981068188','15332134505','584228427425','527309626674','42664441398','43912375058','521323320042','538676446597','537981807976','538472630261','39077636217','547692072595','554594337463','564469531136','606759063053','605448737579','613942642177','591913941639','43984164814','614385291547','577550005785','526571422256','625062481472','610974565021','576412995625','627027420657','611233066987','608016409806','613733106384','534597828259','591301768198','595659100735','558744903450','572824208934','546736954178','591096168038','553315977406','602966857885','562745560200','545472503316','612589349725','601502300394','4359111383','35297395554','608583923935','599053639318','615658388192','616567613998','628533650767','564464151047','613830158676','573927629959','629532946538','591580395532','574402941559','590307176900','544862238428','538080309505','546742438254','42861838038','17289238843','598161855552','547218029710','628568050418','41409480326','598545771935','20332739108','550584884673']
        jd = ['6088552','2254554','5141909','4080819','1670651','100009101355','3639988']
        return tmall, jd


    def hotfix(self, tbl, dba, prefix, params):
        super().hotfix(tbl, dba, prefix, params)
        a2018 = [
            ['jd','1192475','Repair'],
            ['jd','1940313','Moisturizing'],
            ['jd','5601641','Anti-Aging'],
            ['jd','819172','Anti-Aging'],
            ['jd','287403','Moisturizing'],
            ['jd','727034','Anti-Aging'],
            ['jd','189590','Anti-Aging'],
            ['jd','4380096','Anti-Aging'],
            ['jd','182348','Repair'],
            ['jd','5707294','Anti-Aging'],
            ['jd','727020','Anti-Aging'],
            ['jd','6375779','Anti-Aging'],
            ['jd','231447','Anti-Aging'],
            ['jd','7759858','Anti-Aging'],
            ['jd','1750036','Moisturizing'],
            ['jd','6627666','Moisturizing'],
            ['jd','4343840','Moisturizing'],
            ['jd','3543462','Anti-Aging'],
            ['jd','13179797973','Acne Removing'],
            ['jd','2649670','Moisturizing'],
            ['tmall','546753873205','Acne Removing'],
            ['tmall','524361783726','Whitening'],
            ['tmall','44528774859','Anti-Aging'],
            ['tmall','544659483197','Whitening'],
            ['tmall','12976800504','Anti-Aging'],
            ['tmall','43984164814','Anti-Aging'],
            ['tmall','545378712840','Moisturizing'],
            ['tmall','551047203432','Moisturizing'],
            ['tmall','18640065445','Repair'],
            ['tmall','558345947178','Whitening'],
            ['tmall','583150335988','Anti-Aging'],
            ['tmall','535558402669','Whitening'],
            ['tmall','566267504034','Acne Removing'],
            ['tmall','17908625605','Repair'],
            ['tmall','521402561924','Anti-Aging'],
            ['tmall','565231535633','Whitening'],
            ['tmall','20332739108','Repair'],
            ['tmall','17798564300','Anti-Aging'],
            ['tmall','521323320042','Anti-Aging'],
            ['tmall','17289238843','Repair'],
            ['tmall','550723769495','Whitening'],
            ['tmall','559942063695','Whitening'],
            ['tmall','563818467115','Anti-Aging'],
            ['tmall','564464151047','Anti-Aging'],
            ['tmall','538149013945','Moisturizing'],
            ['tmall','537140825702','Repair'],
            ['tmall','564418673991','Repair'],
            ['tmall','561946201889','Whitening'],
            ['tmall','534597828259','Repair'],
            ['tmall','42997766509','Moisturizing'],
            ['tmall','577591940065','Whitening'],
            ['tmall','561876771265','Repair'],
            ['tmall','577194864437','Anti-Aging'],
            ['tmall','561870475654','Whitening'],
            ['tmall','27213588211','Repair'],
            ['tmall','43904982180','Moisturizing'],
            ['tmall','551890255758','Whitening'],
            ['tmall','541559962792','Moisturizing'],
            ['tmall','551232754102','Moisturizing'],
            ['tmall','574381310711','Anti-Aging'],
            ['tmall','565263294649','Acne Removing'],
            ['tmall','537596417609','Whitening'],
            ['tmall','544567915860','Whitening'],
            ['tmall','536072357027','Whitening'],
            ['tmall','562352583843','Repair'],
            ['tmall','534256799031','Whitening'],
            ['tmall','526938577996','Repair'],
            ['tmall','583056750298','Moisturizing'],
            ['tmall','44608674639','Moisturizing'],
            ['tmall','540336822314','Whitening'],
            ['tmall','42923607281','Moisturizing'],
            ['tmall','7391833431','Moisturizing'],
            ['tmall','555730966335','Whitening'],
            ['tmall','580111780433','Whitening'],
            ['tmall','578243377318','Whitening'],
            ['tmall','551464645579','Anti-Aging'],
            ['tmall','527129546690','Acne Removing'],
            ['tmall','540617285170','Moisturizing'],
            ['tmall','554497075371','Repair'],
            ['tmall','540623915571','Repair'],
            ['tmall','43934074987','Anti-Aging'],
            ['tmall','568171759839','Repair'],
            ['tmall','564721169244','Repair'],
            ['tmall','558427795001','Repair'],
            ['tmall','545469810589','Moisturizing'],
            ['tmall','17184638726','Repair'],
            ['tmall','571541824436','anti-aging'],
            ['tmall','521465605447','Repair'],
            ['tmall','539413113746','Whitening'],
            ['tmall','524197754727','Moisturizing'],
            ['tmall','20216863390','Moisturizing'],
            ['tmall','565192686226','Moisturizing'],
            ['tmall','39624124492','Acne Removing'],
            ['tmall','533119990394','Whitening'],
            ['tmall','13588725459','Acne Removing'],
            ['tmall','571819678446','Repair'],
            ['tmall','568547164691','Whitening'],
            ['tmall','39529062412','repair'],
            ['tmall','7824307219','Moisturizing'],
            ['tmall','563629170516','Whitening']
        ]
        a2019 = [
            ['jd','819172','Anti Aging'],
            ['jd','5707294','Anti Aging'],
            ['jd','287403','Moisturizing'],
            ['jd','1192475','Repair'],
            ['jd','5601641','Anti Aging'],
            ['jd','4380096','others'],
            ['jd','2254554','Moisturizing'],
            ['jd','8663830','others'],
            ['jd','7759858','others'],
            ['jd','1750036','Moisturizing'],
            ['jd','189590','Repair'],
            ['jd','6627666','Moisturizing'],
            ['jd','824319','Anti Aging'],
            ['jd','100000883844','Anti Aging'],
            ['jd','727034','Anti Aging'],
            ['jd','7443747','Moisturizing'],
            ['jd','3035579','Anti Aging'],
            ['jd','6375779','Anti Aging'],
            ['tmall','607303458852','Whitening'],
            ['tmall','545378712840','Moisturizing'],
            ['tmall','534597828259','Repair'],
            ['tmall','605518201955','Whitening'],
            ['tmall','43984164814','Anti-Aging'],
            ['tmall','607100157530','Moisturizing'],
            ['tmall','521402561924','Anti-Aging'],
            ['tmall','521323320042','Anti-Aging'],
            ['tmall','598089055725','Whitening'],
            ['tmall','577194864437','Anti-Aging'],
            ['tmall','44528774859','Anti-Aging'],
            ['tmall','599102405447','Anti-Aging'],
            ['tmall','568163328573','Moisturizing'],
            ['tmall','12976800504','Anti-Aging'],
            ['tmall','546753873205','Acne Removing'],
            ['tmall','564464151047','Anti-Aging'],
            ['tmall','601291153216','Moisturizing'],
            ['tmall','17289238843','Repair'],
            ['tmall','544659483197','Whitening'],
            ['tmall','17908625605','Repair'],
            ['tmall','561876771265','Repair'],
            ['tmall','579874989663','Moisturizing'],
            ['tmall','590307176900','Acne Removing'],
            ['tmall','551047203432','Moisturizing'],
            ['tmall','563818467115','Anti Aging'],
            ['tmall','599053639318','Moisturizing'],
            ['tmall','551232754102','Moisturizing'],
            ['tmall','42664441398','Anti Aging'],
            ['tmall','42997766509','Repair'],
            ['tmall','18640065445','Acne Removing'],
            ['tmall','591301768198','Whitening'],
            ['tmall','584228427425','Whitening'],
            ['tmall','583829848522','Whitening'],
            ['tmall','605512131678','Moisturizing'],
            ['tmall','568171759839','Repair'],
            ['tmall','527129546690','Repair'],
            ['tmall','539735660173','Repair'],
            ['tmall','597913311892','Anti Aging'],
            ['tmall','567867586523','Anti Aging'],
            ['tmall','538149013945','Moisturizing'],
            ['tmall','43934074987','Anti Aging'],
            ['tmall','521267837407','Moisturizing'],
            ['tmall','550723769495','Whitening'],
            ['tmall','582615005836','Anti Aging'],
            ['tmall','569153680553','Moisturizing'],
            ['tmall','584230286959','Anti Aging'],
            ['tmall','597220566233','Moisturizing'],
            ['tmall','601315736816','Whitening'],
            ['tmall','567970755369','Anti Aging'],
            ['tmall','608583923935','Anti Aging'],
            ['tmall','599679000294','Repair'],
            ['tmall','565263294649','Repair'],
            ['tmall','575547501041','Anti Aging'],
            ['tmall','588999738929','Moisturizing'],
            ['tmall','537140825702','Repair'],
            ['tmall','17798564300','Repair'],
            ['tmall','571507774301','Whitening'],
            ['tmall','566267504034','Acne Removing'],
            ['tmall','580608613920','Repair'],
            ['tmall','585548090788','Anti Aging'],
            ['tmall','563419345220','Moisturizing'],
            ['tmall','39624124492','Whitening'],
            ['tmall','589696400586','Anti Aging'],
            ['tmall','43904982180','Repair'],
            ['tmall','573836677560','repair'],
            ['tmall','20332739108','Repair'],
            ['tmall','579817240307','Whitening'],
            ['tmall','555901333245','Whitening'],
            ['tmall','571541824436','Anti Aging'],
            ['tmall','608166000241','Moisturizing'],
            ['tmall','578188077692','Whitening'],
            ['tmall','583467125720','Repair'],
            ['tmall','7391833431','Moisturizing'],
            ['tmall','42923607281','Moisturizing'],
            ['tmall','17184638726','Moisturizing'],
            ['tmall','551464645579','Anti Aging'],
            ['tmall','525332729369','Repair'],
            ['tmall','562352583843','Repair'],
            ['tmall','610823479633','Whitening'],
            ['tmall','530825284531','Anti Aging'],
            ['tmall','592120815472','Whitening'],
            ['tmall','40144370031','Moisturizing']
        ]
        a2020 = [
            ['jd','2254554','Moisturizing'],
            ['jd','5707294','Anti Aging'],
            ['jd','287403','Moisturizing'],
            ['jd','819172','Anti Aging'],
            ['jd','3035579','Anti Aging'],
            ['jd','7443747','Moisturizing'],
            ['jd','4380096','others'],
            ['jd','100012951218','Moisturizing'],
            ['jd','2274748','Repair'],
            ['jd','1750036','Moisturizing'],
            ['jd','2673757','Anti Aging'],
            ['jd','1192475','Repair'],
            ['jd','2065269','Repair'],
            ['jd','4972612','Moisturizing'],
            ['jd','6515029','Anti Aging'],
            ['tmall','545378712840','Moisturizing'],
            ['tmall','521402561924','Anti Aging'],
            ['tmall','582615005836','Anti Aging'],
            ['tmall','612290391218','Anti Aging'],
            ['tmall','584228427425','Whitening'],
            ['tmall','42664441398','Anti Aging'],
            ['tmall','521323320042','Anti Aging'],
            ['tmall','43984164814','Anti Aging'],
            ['tmall','627027420657','Repair'],
            ['tmall','534597828259','Repair'],
            ['tmall','591301768198','Whitening'],
            ['tmall','601502300394','Whitening'],
            ['tmall','608583923935','Anti Aging'],
            ['tmall','599053639318','Anti Aging'],
            ['tmall','628533650767','Anti Aging'],
            ['tmall','564464151047','Anti Aging'],
            ['tmall','590307176900','Repair'],
            ['tmall','17289238843','Repair'],
            ['tmall','628568050418','Repair'],
            ['tmall','20332739108','Repair'],
            ['tmall','612372280790','Whitening'],
            ['tmall','12976800504','Anti Aging'],
            ['tmall','629646431171','Anti-Aging'],
            ['tmall','608817714345','Anti Aging'],
            ['tmall','561876771265','Anti Aging'],
            ['tmall','578154324998','Anti Aging'],
            ['tmall','538149013945','Moisturizing'],
            ['tmall','625301501700','Whitening'],
            ['tmall','611653951844','Whitening'],
            ['tmall','525332729369','Repair'],
            ['tmall','43934074987','Anti Aging'],
            ['tmall','597186755339','Anti Aging'],
            ['tmall','568163328573','Repair'],
            ['tmall','629319610284','others'],
            ['tmall','551047203432','Moisturizing'],
            ['tmall','17908625605','Repair'],
            ['tmall','44528774859','Anti Aging'],
            ['tmall','625516635848','Anti Aging'],
            ['tmall','618311832280','Anti Aging'],
            ['tmall','556492269211','Moisturizing'],
            ['tmall','586354998608','Anti Aging'],
            ['tmall','568171759839','Repair'],
            ['tmall','577194864437','Anti Aging'],
            ['tmall','607303458852','Whitening'],
            ['tmall','587556090834','Anti Aging'],
            ['tmall','526586148621','Moisturizing'],
            ['tmall','42997766509','Repair'],
            ['tmall','528655432129','Moisturizing'],
            ['tmall','608366902568','Anti Aging'],
            ['tmall','563818467115','Anti Aging'],
            ['tmall','620708377783','Anti Aging'],
            ['tmall','584596891179','Repair'],
            ['tmall','559316022517','Anti Aging'],
            ['tmall','576200457620','Anti Aging'],
            ['tmall','537140825702','Repair'],
            ['tmall','567970755369','Anti Aging'],
            ['tmall','580608613920','Repair'],
            ['tmall','624199035028','Anti Aging'],
            ['tmall','578392706465','Moisturizing'],
            ['tmall','579874989663','Anti Aging'],
            ['tmall','574381310711','Repair'],
            ['tmall','538106886248','Anti-Aging'],
            ['tmall','573836677560','Repair'],
            ['tmall','566251181326','Anti Aging'],
            ['tmall','599102405447','Anti Aging'],
            ['tmall','611737680961','Repair'],
            ['tmall','588999738929','Moisturizing'],
            ['tmall','617218330650','Moisturizing'],
            ['tmall','565046143264','Whitening'],
            ['tmall','609695388613','Repair'],
            ['tmall','625393643195','Repair'],
            ['tmall','624144577229','Anti Aging'],
            ['tmall','601781242607','Anti Aging'],
            ['tmall','563419345220','Moisturizing'],
            ['tmall','588304554722','Whitening'],
            ['tmall','551232754102','Moisturizing'],
            ['tmall','594710571358','repair'],
            ['tmall','540050494956','Anti Aging'],
            ['tmall','599974154629','Anti Aging'],
            ['tmall','622952870638','Anti Aging'],
            ['tmall','566490347302','Anti Aging'],
            ['tmall','604534271503','Moisturizing'],
            ['tmall','7391833431','Moisturizing'],
            ['tmall','601781806025','Anti Aging'],
            ['tmall','18297865077','Repair']
        ]
        b2018 = [
            ['jd','2349418','Others'],
            ['jd','1670651','Moisturizing'],
            ['jd','3785372','Moisturizing'],
            ['jd','10247830981','Moisturizing'],
            ['jd','4343838','Moisturizing'],
            ['jd','3126016','Whitening'],
            ['jd','1670620','Moisturizing'],
            ['tmall','529201426325','Moisturizing'],
            ['tmall','42861838038','Moisturizing'],
            ['tmall','554594337463','Moisturizing'],
            ['tmall','44359701868','Cleaning'],
            ['tmall','23237224348','Moisturizing'],
            ['tmall','570716725274','Others'],
            ['tmall','522581388334','Cleaning'],
            ['tmall','539339147058','Moisturizing'],
            ['tmall','554777456584','Others'],
            ['tmall','19223957322','Moisturizing'],
            ['tmall','43912195228','Moisturizing'],
            ['tmall','572222539105','Moisturizing'],
            ['tmall','563080385145','Moisturizing'],
            ['tmall','550584884673','Moisturizing'],
            ['tmall','38333829040','Moisturizing'],
            ['tmall','522099256204','Moisturizing'],
            ['tmall','551595936609','Moisturizing'],
            ['tmall','566961679422','Moisturizing'],
            ['tmall','559173360684','Moisturizing'],
            ['tmall','557187258049','Moisturizing'],
            ['tmall','43859993046','Moisturizing'],
            ['tmall','41681863329','Moisturizing'],
            ['tmall','541283129168','Whitening'],
            ['tmall','577457216946','Moisturizing'],
            ['tmall','532725005672','Moisturizing'],
            ['tmall','37407455923','Moisturizing'],
            ['tmall','44379988520','Moisturizing'],
            ['tmall','547025906699','Moisturizing'],
            ['tmall','521073658232','Moisturizing'],
            ['tmall','534035950265','Others'],
            ['tmall','582713947542','Moisturizing'],
            ['tmall','576644195365','Moisturizing'],
            ['tmall','544681355471','Moisturizing'],
            ['tmall','14391207834','Moisturizing'],
            ['tmall','15657673602','Repair'],
            ['tmall','553133804175','Moisturizing'],
            ['tmall','42908784204','Moisturizing'],
            ['tmall','569694860334','Moisturizing'],
            ['tmall','536645052176','Moisturizing'],
            ['tmall','536333848845','Moisturizing'],
            ['tmall','520928380305','Moisturizing'],
            ['tmall','35297395554','Whitening'],
            ['tmall','4359111383','Cleaning'],
            ['tmall','561668287436','Whitening'],
            ['tmall','18098352565','Moisturizing'],
            ['tmall','556013908218','Moisturizing'],
            ['tmall','551182866596','Moisturizing'],
            ['tmall','569168967094','Whitening'],
            ['tmall','39190127313','Moisturizing'],
            ['tmall','35448849351','Moisturizing'],
            ['tmall','545473839106','Cleaning'],
            ['tmall','524783419295','Moisturizing'],
            ['tmall','564109283547','Moisturizing'],
            ['tmall','43080264576','Repair'],
            ['tmall','566079862655','Repair'],
            ['tmall','555709593338','Moisturizing'],
            ['tmall','537118267969','Moisturizing'],
            ['tmall','18990427291','Anti aging'],
            ['tmall','572015937511','Moisturizing'],
            ['tmall','43497006432','Moisturizing'],
            ['tmall','567133740742','Moisturizing'],
            ['tmall','18483428998','Moisturizing'],
            ['tmall','534305594544','Moisturizing'],
            ['tmall','529410430372','Moisturizing'],
            ['tmall','575670698772','Whitening'],
            ['tmall','555617368338','Cleaning'],
            ['tmall','555629058970','Whitening'],
            ['tmall','577447839795','Moisturizing'],
            ['tmall','527897757647','Moisturizing'],
            ['tmall','16199354246','Whitening'],
            ['tmall','570681996305','Moisturizing'],
            ['tmall','583093731376','Whitening'],
            ['tmall','546736954178','Moisturizing'],
            ['tmall','45377041667','Repair'],
            ['tmall','531438298002','Moisturizing'],
            ['tmall','560506461753','Moisturizing'],
            ['tmall','547682242512','others'],
            ['tmall','536104696285','Moisturizing'],
            ['tmall','527549119295','Moisturizing'],
            ['tmall','558010056975','whitening'],
            ['tmall','559435459611','Moisturizing'],
            ['tmall','41924569481','Moisturizing'],
            ['tmall','537778938843','Moisturizing'],
            ['tmall','526418921805','Moisturizing'],
            ['tmall','567421498556','Moisturizing'],
            ['tmall','525872510577','Moisturizing'],
            ['tmall','17669733528','Whitening'],
            ['tmall','572509894213','Moisturizing'],
            ['tmall','540403736982','Moisturizing'],
            ['tmall','563835753385','Whitening'],
            ['tmall','544576249414','Whitening'],
            ['tmall','576167629662','Others'],
            ['tmall','556386198357','Moisturizing']
        ]
        b2019 = [
            ['jd','1670651','Moisturizing'],
            ['jd','2349418','Moisturizing'],
            ['jd','4080819','Moisturizing'],
            ['jd','10247830981','Moisturizing'],
            ['jd','3785372','Moisturizing'],
            ['tmall','529201426325','Moisturizing'],
            ['tmall','579708738059','Cleaning'],
            ['tmall','554594337463','Moisturizing'],
            ['tmall','576412995625','Moisturizing'],
            ['tmall','606761572092','Moisturizing'],
            ['tmall','539339147058','Moisturizing'],
            ['tmall','576644195365','Moisturizing'],
            ['tmall','45496674849','Others'],
            ['tmall','42861838038','Repair'],
            ['tmall','590700533406','Whitening'],
            ['tmall','572824208934','Whitening'],
            ['tmall','572222539105','Moisturizing'],
            ['tmall','569694860334','Moisturizing'],
            ['tmall','609833826986','Moisturizing'],
            ['tmall','44359701868','Whitening'],
            ['tmall','522099256204','Moisturizing'],
            ['tmall','577388543732','Repair'],
            ['tmall','545473839106','Cleaning'],
            ['tmall','594640145573','Repair'],
            ['tmall','606102686980','Cleaning'],
            ['tmall','534305594544','Moisturizing'],
            ['tmall','566961679422','Moisturizing'],
            ['tmall','594248251304','Whitening'],
            ['tmall','19223957322','Moisturizing'],
            ['tmall','590350060474','Whitening'],
            ['tmall','527052101951','Whitening'],
            ['tmall','542490236697','Whitening'],
            ['tmall','527549119295','Whitening'],
            ['tmall','572015937511','Moisturizing'],
            ['tmall','600209868537','Moisturizing'],
            ['tmall','584262580614','Whitening'],
            ['tmall','43912195228','Moisturizing'],
            ['tmall','522581388334','Cleaning'],
            ['tmall','546736954178','Moisturizing'],
            ['tmall','579643097351','Moisturizing'],
            ['tmall','38333829040','Moisturizing'],
            ['tmall','550584884673','Whitening'],
            ['tmall','562745560200','Cleaning'],
            ['tmall','522974844267','Moisturizing'],
            ['tmall','600053488487','Moisturizing'],
            ['tmall','23237224348','Whitening'],
            ['tmall','15657673602','Repair'],
            ['tmall','576022342426','Moisturizing'],
            ['tmall','524783419295','Repair'],
            ['tmall','553540708714','Whitening'],
            ['tmall','43859993046','Moisturizing'],
            ['tmall','582884349816','Anti aging'],
            ['tmall','553133804175','Moisturizing'],
            ['tmall','594374098639','Whitening'],
            ['tmall','602208046846','Whitening'],
            ['tmall','560232241143','Moisturizing'],
            ['tmall','599612713674','Cleaning'],
            ['tmall','592296650882','Whitening'],
            ['tmall','587682721028','Moisturizing'],
            ['tmall','569168967094','Moisturizing'],
            ['tmall','606315723284','Repair'],
            ['tmall','588239875399','Moisturizing'],
            ['tmall','594077730470','Cleaning'],
            ['tmall','532725005672','Moisturizing'],
            ['tmall','544576249414','Whitening'],
            ['tmall','587561704312','Moisturizing'],
            ['tmall','4359111383','Cleaning'],
            ['tmall','529410430372','Moisturizing'],
            ['tmall','520928380305','Moisturizing'],
            ['tmall','547025906699','Moisturizing'],
            ['tmall','603544423940','Moisturizing'],
            ['tmall','605448737579','Anti aging'],
            ['tmall','552440475157','Moisturizing'],
            ['tmall','606376635492','Moisturizing'],
            ['tmall','596377271148','Repair'],
            ['tmall','541283129168','Whitening'],
            ['tmall','586614384440','Moisturizing'],
            ['tmall','14391207834','Moisturizing'],
            ['tmall','604004437192','Anti aging'],
            ['tmall','18483428998','Moisturizing'],
            ['tmall','539379880103','Whitening'],
            ['tmall','551595936609','Moisturizing'],
            ['tmall','579562295376','Cleaning'],
            ['tmall','560506461753','Moisturizing'],
            ['tmall','41681863329','Moisturizing'],
            ['tmall','591951673017','Moisturizing'],
            ['tmall','599155774047','Moisturizing'],
            ['tmall','23480436763','Cleaning'],
            ['tmall','582831353521','Cleaning'],
            ['tmall','526184382952','Repair'],
            ['tmall','563936419695','Moisturizing'],
            ['tmall','532719086371','Cleaning'],
            ['tmall','593087904047','Moisturizing'],
            ['tmall','576433230884','Cleaning'],
            ['tmall','601951712915','Moisturizing'],
            ['tmall','597676990127','Moisturizing'],
            ['tmall','588946118443','Repair'],
            ['tmall','589673115651','Whitening'],
            ['tmall','534035950265','Cleaning'],
            ['tmall','594932506002','Whitening']
        ]
        b2020 = [
            ['jd','4080819','Moisturizing'],
            ['jd','1670651','Moisturizing'],
            ['jd','578436','Cleaning'],
            ['jd','4858894','Moisturizing'],
            ['jd','2990386','Repair'],
            ['jd','7378672','Moisturizing'],
            ['jd','3226169','Cleaning'],
            ['jd','100003174940','Moisturizing'],
            ['jd','7398430','Moisturizing'],
            ['jd','100009178466','Moisturizing'],
            ['tmall','539339147058','Moisturizing'],
            ['tmall','576644195365','Moisturizing'],
            ['tmall','603941978639','Whitening'],
            ['tmall','620084900474','Repair'],
            ['tmall','23480436763','Cleaning'],
            ['tmall','587561704312','Moisturizing'],
            ['tmall','601009111088','Repair'],
            ['tmall','619244244508','Moisturizing'],
            ['tmall','529201426325','Moisturizing'],
            ['tmall','545473839106','Cleaning'],
            ['tmall','554594337463','Cleaning'],
            ['tmall','605448737579','Moisturizing'],
            ['tmall','625062481472','Moisturizing'],
            ['tmall','576412995625','Moisturizing'],
            ['tmall','613733106384','Moisturizing'],
            ['tmall','595659100735','Anti aging'],
            ['tmall','572824208934','Whitening'],
            ['tmall','546736954178','Moisturizing'],
            ['tmall','553315977406','Whitening'],
            ['tmall','562745560200','Cleaning'],
            ['tmall','4359111383','Cleaning'],
            ['tmall','35297395554','Whitening'],
            ['tmall','616567613998','Moisturizing'],
            ['tmall','613830158676','Cleaning'],
            ['tmall','573927629959','Moisturizing'],
            ['tmall','42861838038','Moisturizing'],
            ['tmall','598545771935','Repair'],
            ['tmall','550584884673','Moisturizing'],
            ['tmall','603081302370','Moisturizing'],
            ['tmall','522974844267','Moisturizing'],
            ['tmall','629016637051','Moisturizing'],
            ['tmall','44359701868','Whitening'],
            ['tmall','546180556214','Repair'],
            ['tmall','592679450822','Whitening'],
            ['tmall','619752844042','Cleaning'],
            ['tmall','572222539105','Repair'],
            ['tmall','522099256204','Cleaning'],
            ['tmall','544576249414','Whitening'],
            ['tmall','527052101951','Whitening'],
            ['tmall','618014234463','Moisturizing'],
            ['tmall','560232241143','Moisturizing'],
            ['tmall','576086590617','Moisturizing'],
            ['tmall','41227596533','Moisturizing'],
            ['tmall','534305594544','Moisturizing'],
            ['tmall','531741437214','Moisturizing'],
            ['tmall','592197770064','Moisturizing'],
            ['tmall','619247172903','Moisturizing'],
            ['tmall','569694860334','Moisturizing'],
            ['tmall','526184382952','Repair'],
            ['tmall','522581388334','Repair'],
            ['tmall','582269452395','Moisturizing'],
            ['tmall','566961679422','Moisturizing'],
            ['tmall','524783419295','Moisturizing'],
            ['tmall','627892249574','Moisturizing'],
            ['tmall','613044463645','Whitening'],
            ['tmall','592296650882','Whitening'],
            ['tmall','602547669818','Whitening'],
            ['tmall','602916089086','Moisturizing'],
            ['tmall','15657673602','Repair'],
            ['tmall','593208087360','Whitening'],
            ['tmall','38333829040','Moisturizing'],
            ['tmall','613888045429','Whitening'],
            ['tmall','612365380055','Moisturizing'],
            ['tmall','579643097351','Moisturizing'],
            ['tmall','586991921430','Whitening'],
            ['tmall','613940823855','Moisturizing'],
            ['tmall','605694503214','Moisturizing'],
            ['tmall','595742243543','Anti aging'],
            ['tmall','606284760975','Moisturizing'],
            ['tmall','539379880103','Whitening'],
            ['tmall','19223957322','Moisturizing'],
            ['tmall','553133804175','Moisturizing'],
            ['tmall','583184933292','Moisturizing'],
            ['tmall','616372643827','Whitening'],
            ['tmall','544334571935','Anti aging'],
            ['tmall','601905410425','Moisturizing'],
            ['tmall','594374098639','Whitening'],
            ['tmall','597656245104','Repair'],
            ['tmall','622712322504','Repair'],
            ['tmall','630891842804','Repair'],
            ['tmall','613735815766','Moisturizing'],
            ['tmall','621794557561','Anti aging'],
            ['tmall','582884349816','Anti aging'],
            ['tmall','625469697907','Anti aging'],
            ['tmall','613957291655','Anti aging'],
            ['tmall','547025906699','Moisturizing'],
            ['tmall','579562295376','Moisturizing'],
            ['tmall','616126828750','Moisturizing'],
            ['tmall','601150815100','Anti aging'],
            ['tmall','552440475157','Moisturizing']
        ]
        c2018 = [
            ['jd','200868','Repair'],
            ['jd','304958','Moisturizing'],
            ['jd','1303009','Moisturizing'],
            ['jd','432752','Moisturizing'],
            ['jd','3067657','Anti-Aging'],
            ['jd','3198705','Moisturizing'],
            ['jd','3308953','Moisturizing'],
            ['jd','3823521','Moisturizing'],
            ['jd','3342868','Moisturizing'],
            ['jd','31511571020','Acne Removing'],
            ['jd','2376965','Moisturizing'],
            ['jd','3543468','Anti-Aging'],
            ['jd','819163','Anti-Aging'],
            ['jd','8663568','Moisturizing'],
            ['jd','7224118','Anti-Aging'],
            ['jd','2186660','Moisturizing'],
            ['jd','380071','Moisturizing'],
            ['jd','4258996','Moisturizing'],
            ['jd','1168766','Moisturizing'],
            ['jd','4787207','Anti-Aging'],
            ['tmall','43249505908','Moisturizing'],
            ['tmall','544733625220','Moisturizing'],
            ['tmall','542679906360','Moisturizing'],
            ['tmall','520711852230','Moisturizing'],
            ['tmall','40647145903','Moisturizing'],
            ['tmall','21701120378','Moisturizing'],
            ['tmall','522198475354','Repair'],
            ['tmall','530435165907','Repair'],
            ['tmall','542677952103','Repair'],
            ['tmall','545379144839','Moisturizing'],
            ['tmall','537839593545','Repair'],
            ['tmall','549805540159','Moisturizing'],
            ['tmall','548459514632','Moisturizing'],
            ['tmall','7805869963','Moisturizing'],
            ['tmall','556894369038','Moisturizing'],
            ['tmall','578233582047','Repair'],
            ['tmall','527186024180','Moisturizing'],
            ['tmall','531553150021','Repair'],
            ['tmall','542480138889','Moisturizing'],
            ['tmall','572570241728','Moisturizing'],
            ['tmall','548597706231','Moisturizing'],
            ['tmall','533098872301','Moisturizing'],
            ['tmall','579895677046','Anti-Aging'],
            ['tmall','12589846591','Anti-Aging'],
            ['tmall','38622701169','Anti-Aging'],
            ['tmall','19445947936','Repair'],
            ['tmall','529063454792','Anti-Aging'],
            ['tmall','520419636793','Acne Removing'],
            ['tmall','563795728631','Moisturizing'],
            ['tmall','558825224835','Repair'],
            ['tmall','557642631412','Moisturizing'],
            ['tmall','525553688181','Moisturizing'],
            ['tmall','530463528183','Acne Removing'],
            ['tmall','521896948515','Moisturizing'],
            ['tmall','565548886049','Moisturizing'],
            ['tmall','534060402302','Repair'],
            ['tmall','558218001017','Repair'],
            ['tmall','43428859386','Moisturizing'],
            ['tmall','557598406849','Moisturizing'],
            ['tmall','42175628307','Repair'],
            ['tmall','18208777883','Moisturizing'],
            ['tmall','542310923398','Moisturizing'],
            ['tmall','555795411649','Moisturizing'],
            ['tmall','41393779409','Moisturizing'],
            ['tmall','12804826049','Moisturizing'],
            ['tmall','43540382225','Moisturizing'],
            ['tmall','571968360091','Repair'],
            ['tmall','542313724681','Acne Removing'],
            ['tmall','536464930514','Anti-Aging'],
            ['tmall','18911353336','Moisturizing'],
            ['tmall','574806690770','Acne Removing'],
            ['tmall','565827724242','Repair'],
            ['tmall','571915263151','Repair'],
            ['tmall','524622452917','Moisturizing'],
            ['tmall','581549520622','Anti-Aging'],
            ['tmall','4245205380','Moisturizing'],
            ['tmall','531553126031','Moisturizing'],
            ['tmall','18417082774','Repair'],
            ['tmall','40392547717','Moisturizing'],
            ['tmall','525238363875','whitening'],
            ['tmall','543844899778','Moisturizing'],
            ['tmall','15239426065','Moisturizing'],
            ['tmall','556398850774','Moisturizing'],
            ['tmall','16541174270','Moisturizing'],
            ['tmall','546627924305','Moisturizing'],
            ['tmall','27616996800','Moisturizing'],
            ['tmall','544751310785','Moisturizing'],
            ['tmall','559006651500','Moisturizing'],
            ['tmall','43935298255','Moisturizing'],
            ['tmall','561812971200','Moisturizing'],
            ['tmall','575101377798','Moisturizing'],
            ['tmall','560019615299','Moisturizing'],
            ['tmall','545471742598','Moisturizing'],
            ['tmall','533758988254','Moisturizing'],
            ['tmall','37264853308','Repair'],
            ['tmall','520518999212','Moisturizing'],
            ['tmall','557461421148','Moisturizing'],
            ['tmall','18919906680','Moisturizing'],
            ['tmall','581572746255','Moisturizing'],
            ['tmall','520700388867','Moisturizing']
        ]
        c2019 = [
            ['jd','432752','Moisturizing'],
            ['jd','2144269','Moisturizing'],
            ['jd','200868','Repair'],
            ['jd','8663568','Moisturizing'],
            ['jd','1303009','Moisturizing'],
            ['jd','304958','Moisturizing'],
            ['jd','4562805','Moisturizing'],
            ['jd','3198705','Repair'],
            ['jd','2215373','Repair'],
            ['jd','3308953','Moisturizing'],
            ['jd','8574849','Moisturizing'],
            ['jd','100000168556','Repair'],
            ['jd','26699974572','Moisturizing'],
            ['jd','3439081','Moisturizing'],
            ['jd','1938383','Repair'],
            ['jd','726269','Moisturizing'],
            ['jd','1168766','Moisturizing'],
            ['jd','3823521','Moisturizing'],
            ['jd','100006650664','others'],
            ['jd','3342868','Moisturizing'],
            ['jd','3543468','Anti aging'],
            ['tmall','43249505908','Moisturizing'],
            ['tmall','545379144839','Moisturizing'],
            ['tmall','522198475354','Moisturizing'],
            ['tmall','40647145903','Anti aging'],
            ['tmall','579895677046','Whitening'],
            ['tmall','596771289892','Whitening'],
            ['tmall','542679906360','Repair'],
            ['tmall','520419636793','Acne removing'],
            ['tmall','592302756566','Whitening'],
            ['tmall','520711852230','Repair'],
            ['tmall','530435165907','Repair'],
            ['tmall','544733625220','Moisturizing'],
            ['tmall','537839593545','Moisturizing'],
            ['tmall','593071394866','Moisturizing'],
            ['tmall','533098872301','Moisturizing'],
            ['tmall','521896948515','Moisturizing'],
            ['tmall','578958118534','Moisturizing'],
            ['tmall','527693704600','Moisturizing'],
            ['tmall','527186024180','Moisturizing'],
            ['tmall','21701120378','Moisturizing'],
            ['tmall','7805869963','Moisturizing'],
            ['tmall','538765673144','Repair'],
            ['tmall','573013177383','Moisturizing'],
            ['tmall','576046620375','Moisturizing'],
            ['tmall','586711177977','Repair'],
            ['tmall','594081963380','Moisturizing'],
            ['tmall','12589846591','Moisturizing'],
            ['tmall','577552401435','Repair'],
            ['tmall','38622701169','Moisturizing'],
            ['tmall','536464930514','Moisturizing'],
            ['tmall','593647979249','Moisturizing'],
            ['tmall','529063454792','Moisturizing'],
            ['tmall','523081653263','Moisturizing'],
            ['tmall','525553688181','Moisturizing'],
            ['tmall','19445947936','Repair'],
            ['tmall','561812971200','Moisturizing'],
            ['tmall','542310923398','Moisturizing'],
            ['tmall','573462105680','Moisturizing'],
            ['tmall','609028863313','Whitening'],
            ['tmall','556894369038','Moisturizing'],
            ['tmall','583397925868','Repair'],
            ['tmall','558825224835','Repair'],
            ['tmall','548597706231','Repair'],
            ['tmall','560019615299','Moisturizing'],
            ['tmall','557461421148','Moisturizing'],
            ['tmall','593816657774','Moisturizing'],
            ['tmall','27616996800','Moisturizing'],
            ['tmall','520518999212','Moisturizing'],
            ['tmall','583754400139','Acne removing'],
            ['tmall','43935298255','Moisturizing'],
            ['tmall','18208777883','Moisturizing'],
            ['tmall','594653475861','Moisturizing'],
            ['tmall','572742855127','Moisturizing'],
            ['tmall','593516892122','Moisturizing'],
            ['tmall','578401129111','Moisturizing'],
            ['tmall','562657221687','Moisturizing'],
            ['tmall','545471742598','Moisturizing'],
            ['tmall','545567821538','Anti aging'],
            ['tmall','578414972941','Repair'],
            ['tmall','41393779409','Moisturizing'],
            ['tmall','531553150021','Repair'],
            ['tmall','546349858916','Moisturizing'],
            ['tmall','530463528183','Acne removing'],
            ['tmall','590465739803','Moisturizing'],
            ['tmall','15239426065','Moisturizing'],
            ['tmall','551223127386','Moisturizing'],
            ['tmall','565548886049','Acne removing'],
            ['tmall','548459514632','Moisturizing'],
            ['tmall','582692848969','Whitening'],
            ['tmall','598843743351','Moisturizing'],
            ['tmall','590147377419','Moisturizing'],
            ['tmall','546666778011','Moisturizing'],
            ['tmall','582018757782','Moisturizing'],
            ['tmall','586738168259','Repair'],
            ['tmall','557598406849','Whitening'],
            ['tmall','4245205380','Moisturizing'],
            ['tmall','41371708872','Moisturizing'],
            ['tmall','556291091720','Moisturizing'],
            ['tmall','607863558802','Moisturizing']
        ]
        c2020 = [
            ['jd','100011480214','Moisturizing'],
            ['jd','8574849','Moisturizing'],
            ['jd','100010958778','Moisturizing'],
            ['jd','200868','Repair'],
            ['jd','304958','Moisturizing'],
            ['jd','1303009','Moisturizing'],
            ['jd','8663568','Moisturizing'],
            ['jd','3202871','Repair'],
            ['jd','3439081','Moisturizing'],
            ['jd','2215373','Moisturizing'],
            ['jd','2990382','Moisturizing'],
            ['jd','1938383','Repair'],
            ['jd','3198705','Moisturizing'],
            ['jd','3342868','Moisturizing'],
            ['jd','100000168556','Moisturizing'],
            ['jd','3209963','Moisturizing'],
            ['jd','3812181','Moisturizing'],
            ['jd','100000159907','Moisturizing'],
            ['jd','4562805','Moisturizing'],
            ['jd','1168766','Moisturizing'],
            ['jd','2184663','Moisturizing'],
            ['jd','726269','Moisturizing'],
            ['jd','1750019','Moisturizing'],
            ['tmall','43249505908','Moisturizing'],
            ['tmall','545379144839','Moisturizing'],
            ['tmall','40647145903','Moisturizing'],
            ['tmall','629981267581','Moisturizing'],
            ['tmall','520711852230','Repair'],
            ['tmall','542679906360','Repair'],
            ['tmall','533098872301','Moisturizing'],
            ['tmall','522198475354','Moisturizing'],
            ['tmall','578958118534','Moisturizing'],
            ['tmall','520419636793','Acne removing'],
            ['tmall','579895677046','Moisturizing'],
            ['tmall','612297295612','Moisturizing'],
            ['tmall','536464930514','others'],
            ['tmall','521896948515','Moisturizing'],
            ['tmall','552836939288','Moisturizing'],
            ['tmall','530435165907','Repair'],
            ['tmall','586711177977','Repair'],
            ['tmall','602475861203','Moisturizing'],
            ['tmall','44016505831','Moisturizing'],
            ['tmall','527186024180','Moisturizing'],
            ['tmall','624701432089','Moisturizing'],
            ['tmall','620275282921','Acne removing'],
            ['tmall','593516892122','Moisturizing'],
            ['tmall','542310923398','Moisturizing'],
            ['tmall','612877933112','Moisturizing'],
            ['tmall','626617394933','Moisturizing'],
            ['tmall','601467256038','Moisturizing'],
            ['tmall','599217001492','whitening'],
            ['tmall','619315681552','Moisturizing'],
            ['tmall','630350585240','Moisturizing'],
            ['tmall','613579553573','Moisturizing'],
            ['tmall','627483816534','Moisturizing'],
            ['tmall','7805869963','Moisturizing'],
            ['tmall','614961665656','Moisturizing'],
            ['tmall','19445947936','Repair'],
            ['tmall','627121714370','Anti aging'],
            ['tmall','527693704600','Repair'],
            ['tmall','544733625220','Moisturizing'],
            ['tmall','15239426065','Moisturizing'],
            ['tmall','529063454792','Moisturizing'],
            ['tmall','21701120378','Moisturizing'],
            ['tmall','537839593545','Repair'],
            ['tmall','43935298255','Moisturizing'],
            ['tmall','623923974254','Moisturizing'],
            ['tmall','577552401435','Moisturizing'],
            ['tmall','27616996800','Moisturizing'],
            ['tmall','12589846591','Moisturizing'],
            ['tmall','592265630469','Moisturizing'],
            ['tmall','551132945862','Acne removing'],
            ['tmall','18208777883','Repair'],
            ['tmall','558825224835','Moisturizing'],
            ['tmall','578161128957','Anti aging'],
            ['tmall','545567821538','Repair'],
            ['tmall','583397925868','Repair'],
            ['tmall','624139076674','Moisturizing'],
            ['tmall','590516026176','Acne removing'],
            ['tmall','604323306730','Moisturizing'],
            ['tmall','546627924305','Moisturizing'],
            ['tmall','40960059838','Moisturizing'],
            ['tmall','545471742598','Moisturizing'],
            ['tmall','586738168259','Anti aging'],
            ['tmall','594081963380','Moisturizing'],
            ['tmall','561812971200','Acne removing'],
            ['tmall','602374966975','Moisturizing'],
            ['tmall','41393779409','Moisturizing'],
            ['tmall','40976099526','Moisturizing'],
            ['tmall','611391388734','Anti aging'],
            ['tmall','538765673144','Repair'],
            ['tmall','548597706231','Repair'],
            ['tmall','613758437973','Repair'],
            ['tmall','565049873539','Moisturizing'],
            ['tmall','43540382225','Moisturizing'],
            ['tmall','37264853308','repair'],
            ['tmall','523081653263','Moisturizing'],
            ['tmall','573013177383','Moisturizing'],
            ['tmall','596966346647','Moisturizing'],
            ['tmall','624755809137','Moisturizing']
        ]
        d2018 = [
            ['tmall','526498885740','Whitening'],
            ['tmall','581539855170','Whitening'],
            ['tmall','40993307163','Acne Removing'],
            ['tmall','575782237042','Moisturizing'],
            ['tmall','539379501045','Whitening'],
            ['tmall','15332134505','Moisturizing'],
            ['tmall','16989611811','Whitening'],
            ['tmall','522216409648','Repair'],
            ['tmall','538766297543','Whitening'],
            ['tmall','12669264079','Anti-Aging'],
            ['tmall','580645096694','Whitening'],
            ['tmall','45495763965','Anti-Aging'],
            ['tmall','554617551185','Repair'],
            ['tmall','544828890290','Moisturizing'],
            ['tmall','537981807976','Anti-Aging'],
            ['tmall','38848279045','Repair'],
            ['tmall','547692072595','Acne Removing'],
            ['tmall','582360161332','Moisturizing'],
            ['tmall','551495418771','Moisturizing'],
            ['tmall','526571422256','Whitening'],
            ['tmall','577650594133','Repair'],
            ['tmall','574289618122','Moisturizing'],
            ['tmall','43829432738','Repair'],
            ['tmall','582523258850','Moisturizing'],
            ['tmall','520118673063','Anti-Aging'],
            ['tmall','527309626674','Repair'],
            ['tmall','583500953815','Whitening'],
            ['tmall','540788108689','Whitening'],
            ['tmall','35449298302','Whitening'],
            ['tmall','526179402881','Anti-Aging'],
            ['tmall','43912375058','Repair'],
            ['tmall','544862238428','Moisturizing'],
            ['tmall','544848335619','Others'],
            ['tmall','44025627640','Repair'],
            ['tmall','553345567288','Repair'],
            ['tmall','554916646888','Whitening'],
            ['tmall','558491186649','Repair'],
            ['tmall','564456015302','Moisturizing'],
            ['tmall','564469531136','Anti-Aging'],
            ['tmall','568656458029','Whitening'],
            ['tmall','558744903450','Repair'],
            ['tmall','527173176024','Whitening'],
            ['tmall','553819357106','Moisturizing'],
            ['tmall','549937737779','Acne Removing'],
            ['tmall','35073674546','Acne Removing'],
            ['tmall','542529078230','Oil Control'],
            ['tmall','574402941559','Others'],
            ['tmall','580681562112','Anti-Aging'],
            ['tmall','556345893249','Moisturizing'],
            ['tmall','544672465041','Moisturizing'],
            ['tmall','552269136620','Anti-Aging'],
            ['tmall','570793838455','Acne Removing'],
            ['tmall','547218029710','Whitening'],
            ['tmall','560467033404','Acne Removing'],
            ['tmall','44989746304','Whitening'],
            ['tmall','564905061684','Repair'],
            ['tmall','567489754348','Whitening'],
            ['tmall','15253711364','Anti-Aging'],
            ['tmall','582942311110','Moisturizing'],
            ['tmall','41011966298','Whitening'],
            ['tmall','548455665111','Moisturizing'],
            ['tmall','562764818966','Anti-Aging'],
            ['tmall','551717576689','Anti-Aging'],
            ['tmall','537935169661','Acne Removing'],
            ['tmall','559344395011','Anti-Aging'],
            ['tmall','573600347987','Moisturizing'],
            ['tmall','561402613862','Moisturizing'],
            ['tmall','579802110127','Moisturizing'],
            ['tmall','545472503316','Whitening'],
            ['tmall','568844868571','Whitening'],
            ['tmall','537267540405','Moisturizing'],
            ['tmall','558140513517','Moisturizing'],
            ['tmall','574123673472','Anti-Aging'],
            ['tmall','45015913370','Moisturizing'],
            ['tmall','538676446597','Acne Removing'],
            ['tmall','573513023145','Anti-Aging'],
            ['tmall','41409480326','Repair'],
            ['tmall','582038809497','Anti-Aging'],
            ['tmall','39077636217','Repair'],
            ['tmall','40929354653','Moisturizing'],
            ['tmall','574011171844','Anti-Aging'],
            ['tmall','537356084025','Acne Removing'],
            ['tmall','582293191751','Anti-Aging'],
            ['tmall','557794746948','Whitening'],
            ['tmall','529800689450','Moisturizing'],
            ['tmall','546774066977','Whitening'],
            ['tmall','19002035194','Whitening'],
            ['tmall','581576374634','Whitening'],
            ['tmall','565748763430','Moisturizing'],
            ['tmall','554748857204','Acne Removing'],
            ['tmall','567722070813','Whitening'],
            ['tmall','530528859124','Acne Removing'],
            ['tmall','582839293737','Repair'],
            ['tmall','520574869989','Repair'],
            ['tmall','562765301470','Moisturizing'],
            ['tmall','547620782300','Acne Removing'],
            ['tmall','552860633057','Anti-Aging'],
            ['tmall','39046326315','Repair'],
            ['tmall','537822333314','Moisturizing'],
            ['tmall','577267814427','Anti-Aging']
        ]
        d2019 = [
            ['tmall','537981807976','Anti-Aging'],
            ['tmall','16989611811','Whitening'],
            ['tmall','539379501045','Anti-Aging'],
            ['tmall','38848279045','Repair'],
            ['tmall','12669264079','Anti-Aging'],
            ['tmall','526498885740','Whitening'],
            ['tmall','43829432738','Repair'],
            ['tmall','538766297543','Whitening'],
            ['tmall','44989746304','Whitening'],
            ['tmall','547692072595','Acne Removing'],
            ['tmall','566446518116','Repair'],
            ['tmall','527309626674','Repair'],
            ['tmall','15332134505','Moisturizing'],
            ['tmall','580645096694','Anti-Aging'],
            ['tmall','564469531136','Anti-Aging'],
            ['tmall','586804129353','Anti-Aging'],
            ['tmall','597585118157','Anti-Aging'],
            ['tmall','44025627640','Repair'],
            ['tmall','577550005785','Anti-Aging'],
            ['tmall','526571422256','Moisturizing'],
            ['tmall','569844883057','Anti-Aging'],
            ['tmall','45495763965','Anti-Aging'],
            ['tmall','40993307163','Acne Removing'],
            ['tmall','520574869989','Repair'],
            ['tmall','522216409648','Repair'],
            ['tmall','591096168038','Whitening'],
            ['tmall','43912375058','Repair'],
            ['tmall','597526826019','Repair'],
            ['tmall','574402941559','Others'],
            ['tmall','591913941639','Moisturizing'],
            ['tmall','544828890290','Moisturizing'],
            ['tmall','577650594133','Moisturizing'],
            ['tmall','558744903450','Anti-Aging'],
            ['tmall','526179402881','Anti-Aging'],
            ['tmall','551495418771','Moisturizing'],
            ['tmall','538676446597','Acne Removing'],
            ['tmall','564912845613','Whitening'],
            ['tmall','547218029710','Whitening'],
            ['tmall','545472503316','Whitening'],
            ['tmall','602602737781','Moisturizing'],
            ['tmall','39077636217','Repair'],
            ['tmall','562404174771','Moisturizing'],
            ['tmall','596322176743','Others'],
            ['tmall','581539855170','Anti-Aging'],
            ['tmall','590708445128','Anti-Aging'],
            ['tmall','527173176024','Whitening'],
            ['tmall','533038449570','Oil Control'],
            ['tmall','544862238428','Moisturizing'],
            ['tmall','583523389925','Moisturizing'],
            ['tmall','554617551185','Repair'],
            ['tmall','553345567288','Repair'],
            ['tmall','591580395532','Anti-Aging'],
            ['tmall','579814024698','Acne Removing'],
            ['tmall','43737336583','Repair'],
            ['tmall','523082958415','Repair'],
            ['tmall','601585183935','Whitening'],
            ['tmall','43213075039','Anti-Aging'],
            ['tmall','520118673063','Anti-Aging'],
            ['tmall','599059148813','Whitening'],
            ['tmall','564905061684','Anti-Aging'],
            ['tmall','602165226096','Whitening'],
            ['tmall','594024137889','Whitening'],
            ['tmall','14762499647','Moisturizing'],
            ['tmall','580681562112','Anti-Aging'],
            ['tmall','586373581758','Whitening'],
            ['tmall','578217096472','Whitening'],
            ['tmall','559952082370','Moisturizing'],
            ['tmall','586505588009','Acne Removing'],
            ['tmall','540788108689','Whitening'],
            ['tmall','552269136620','Anti-Aging'],
            ['tmall','564591289541','Repair'],
            ['tmall','596789081360','Anti-Aging'],
            ['tmall','596335364202','Anti-Aging'],
            ['tmall','590742435616','Anti-Aging'],
            ['tmall','18250630014','Whitening'],
            ['tmall','570793838455','Acne Removing'],
            ['tmall','580508157620','Whitening'],
            ['tmall','533044394511','Repair'],
            ['tmall','537935169661','Acne Removing'],
            ['tmall','35073674546','Acne Removing'],
            ['tmall','597931059709','Repair'],
            ['tmall','587748628625','Moisturizing'],
            ['tmall','521058998247','Repair'],
            ['tmall','593237613487','Repair'],
            ['tmall','553819357106','Anti-Aging'],
            ['tmall','575987851865','Whitening'],
            ['tmall','596403044776','Acne Removing'],
            ['tmall','556055778315','Repair'],
            ['tmall','578155282929','Repair'],
            ['tmall','577164040664','Whitening'],
            ['tmall','575323772872','Whitening'],
            ['tmall','599840625774','Whitening'],
            ['tmall','564456015302','Moisturizing'],
            ['tmall','596688771362','Whitening'],
            ['tmall','589268231099','Whitening'],
            ['tmall','586360146509','Moisturizing'],
            ['tmall','567722070813','Repair'],
            ['tmall','586540896268','Repair'],
            ['tmall','597096288825','Acne Removing'],
            ['tmall','580831711941','Repair']
        ]
        d2020 = [
            ['tmall','38848279045','Repair'],
            ['tmall','12669264079','Anti-Aging'],
            ['tmall','597585118157','Repair'],
            ['tmall','16989611811','Whitening'],
            ['tmall','539379501045','Whitening'],
            ['tmall','566446518116','Repair'],
            ['tmall','526498885740','Whitening'],
            ['tmall','538766297543','Whitening'],
            ['tmall','521058998247','Repair'],
            ['tmall','44025627640','Repair'],
            ['tmall','613981068188','Repair'],
            ['tmall','15332134505','Moisturizing'],
            ['tmall','527309626674','Repair'],
            ['tmall','43912375058','Repair'],
            ['tmall','538676446597','Acne Removing'],
            ['tmall','537981807976','Anti-Aging'],
            ['tmall','538472630261','Repair'],
            ['tmall','39077636217','Repair'],
            ['tmall','547692072595','Acne Removing'],
            ['tmall','564469531136','Anti-Aging'],
            ['tmall','606759063053','Anti-Aging'],
            ['tmall','613942642177','Repair'],
            ['tmall','591913941639','Moisturizing'],
            ['tmall','614385291547','Repair'],
            ['tmall','577550005785','Anti-Aging'],
            ['tmall','526571422256','Whitening'],
            ['tmall','611233066987','Whitening'],
            ['tmall','608016409806','Others'],
            ['tmall','558744903450','Anti-Aging'],
            ['tmall','591096168038','Whitening'],
            ['tmall','602966857885','Whitening'],
            ['tmall','545472503316','Whitening'],
            ['tmall','612589349725','Whitening'],
            ['tmall','615658388192','Moisturizing'],
            ['tmall','591580395532','Anti-Aging'],
            ['tmall','574402941559','Others'],
            ['tmall','544862238428','Moisturizing'],
            ['tmall','538080309505','Repair'],
            ['tmall','546742438254','Repair'],
            ['tmall','598161855552','Repair'],
            ['tmall','547218029710','Whitening'],
            ['tmall','41409480326','Repair'],
            ['tmall','42671628346','Repair'],
            ['tmall','616945409340','Whitening'],
            ['tmall','564912845613','Whitening'],
            ['tmall','586373581758','Whitening'],
            ['tmall','560951345743','Whitening'],
            ['tmall','559952082370','Moisturizing'],
            ['tmall','608467903110','Acne Removing'],
            ['tmall','576078414953','Repair'],
            ['tmall','613869112484','Anti-Aging'],
            ['tmall','18250630014','Anti-Aging'],
            ['tmall','586505588009','Acne Removing'],
            ['tmall','575879060887','Anti-Aging'],
            ['tmall','562404174771','Moisturizing'],
            ['tmall','620909794925','Repair'],
            ['tmall','45495763965','Repair'],
            ['tmall','617460042048','Acne Removing'],
            ['tmall','574521469169','Repair'],
            ['tmall','526179402881','Anti-Aging'],
            ['tmall','535587823258','Repair'],
            ['tmall','616218858118','Anti-Aging'],
            ['tmall','612240189260','Anti-Aging'],
            ['tmall','610950216759','Whitening'],
            ['tmall','628611264156','Whitening'],
            ['tmall','612830803971','Anti-Aging'],
            ['tmall','564905061684','Anti-Aging'],
            ['tmall','626259214520','Anti-Aging'],
            ['tmall','610706716420','Anti-Aging'],
            ['tmall','608769838418','Moisturizing'],
            ['tmall','623099729554','Whitening'],
            ['tmall','611740523900','Others'],
            ['tmall','40993307163','Anti-Aging'],
            ['tmall','587748628625','Repair'],
            ['tmall','599050932692','Anti-Aging'],
            ['tmall','522216409648','Repair'],
            ['tmall','554617551185','Repair'],
            ['tmall','614747479142','Whitening'],
            ['tmall','543296668722','Moisturizing'],
            ['tmall','606576023266','Whitening'],
            ['tmall','533044394511','Repair'],
            ['tmall','577875075059','Repair'],
            ['tmall','611771548884','Anti-Aging'],
            ['tmall','537935169661','Acne Removing'],
            ['tmall','629047616338','Repair'],
            ['tmall','40929354653','Anti-Aging'],
            ['tmall','537110235442','Whitening'],
            ['tmall','586804129353','Anti-Aging'],
            ['tmall','603196511033','Anti-Aging'],
            ['tmall','628686664556','Repair'],
            ['tmall','536627324975','Anti-Aging'],
            ['tmall','537893918378','Acne Removing'],
            ['tmall','627247797278','Repair'],
            ['tmall','611490486637','Whitening'],
            ['tmall','560696335086','Repair'],
            ['tmall','38622701169','Moisturizing'],
            ['tmall','613066288161','Anti-Aging'],
            ['tmall','612572042882','Repair'],
            ['tmall','527173176024','Whitening'],
            ['tmall','627330757140','Whitening']
        ]
        a2018a_ali = ['\'{}\''.format(v[1]) for v in a2018 if v[0] == 'tmall']
        a2018b_ali = ['\'{}\''.format(v[2]) for v in a2018 if v[0] == 'tmall']
        a2018c_ali = ['\'Facial cream\'' for v in a2018 if v[0] == 'tmall']
        a2018a_jd = ['\'{}\''.format(v[1]) for v in a2018 if v[0] == 'jd']
        a2018b_jd = ['\'{}\''.format(v[2]) for v in a2018 if v[0] == 'jd']
        a2018c_jd = ['\'Facial cream\'' for v in a2018 if v[0] == 'jd']

        a2019a_ali = ['\'{}\''.format(v[1]) for v in a2019 if v[0] == 'tmall']
        a2019b_ali = ['\'{}\''.format(v[2]) for v in a2019 if v[0] == 'tmall']
        a2019c_ali = ['\'Facial cream\'' for v in a2019 if v[0] == 'tmall']
        a2019a_jd = ['\'{}\''.format(v[1]) for v in a2019 if v[0] == 'jd']
        a2019b_jd = ['\'{}\''.format(v[2]) for v in a2019 if v[0] == 'jd']
        a2019c_jd = ['\'Facial cream\'' for v in a2019 if v[0] == 'jd']

        a2020a_ali = ['\'{}\''.format(v[1]) for v in a2020 if v[0] == 'tmall']
        a2020b_ali = ['\'{}\''.format(v[2]) for v in a2020 if v[0] == 'tmall']
        a2020c_ali = ['\'Facial cream\'' for v in a2020 if v[0] == 'tmall']
        a2020a_jd = ['\'{}\''.format(v[1]) for v in a2020 if v[0] == 'jd']
        a2020b_jd = ['\'{}\''.format(v[2]) for v in a2020 if v[0] == 'jd']
        a2020c_jd = ['\'Facial cream\'' for v in a2020 if v[0] == 'jd']

        b2018a_ali = ['\'{}\''.format(v[1]) for v in b2018 if v[0] == 'tmall']
        b2018b_ali = ['\'{}\''.format(v[2]) for v in b2018 if v[0] == 'tmall']
        b2018c_ali = ['\'Mask\'' for v in b2018 if v[0] == 'tmall']
        b2018a_jd = ['\'{}\''.format(v[1]) for v in b2018 if v[0] == 'jd']
        b2018b_jd = ['\'{}\''.format(v[2]) for v in b2018 if v[0] == 'jd']
        b2018c_jd = ['\'Mask\'' for v in b2018 if v[0] == 'jd']

        b2019a_ali = ['\'{}\''.format(v[1]) for v in b2019 if v[0] == 'tmall']
        b2019b_ali = ['\'{}\''.format(v[2]) for v in b2019 if v[0] == 'tmall']
        b2019c_ali = ['\'Mask\'' for v in b2019 if v[0] == 'tmall']
        b2019a_jd = ['\'{}\''.format(v[1]) for v in b2019 if v[0] == 'jd']
        b2019b_jd = ['\'{}\''.format(v[2]) for v in b2019 if v[0] == 'jd']
        b2019c_jd = ['\'Mask\'' for v in b2019 if v[0] == 'jd']

        b2020a_ali = ['\'{}\''.format(v[1]) for v in b2020 if v[0] == 'tmall']
        b2020b_ali = ['\'{}\''.format(v[2]) for v in b2020 if v[0] == 'tmall']
        b2020c_ali = ['\'Mask\'' for v in b2020 if v[0] == 'tmall']
        b2020a_jd = ['\'{}\''.format(v[1]) for v in b2020 if v[0] == 'jd']
        b2020b_jd = ['\'{}\''.format(v[2]) for v in b2020 if v[0] == 'jd']
        b2020c_jd = ['\'Mask\'' for v in b2020 if v[0] == 'jd']

        c2018a_ali = ['\'{}\''.format(v[1]) for v in c2018 if v[0] == 'tmall']
        c2018b_ali = ['\'{}\''.format(v[2]) for v in c2018 if v[0] == 'tmall']
        c2018c_ali = ['\'Gel/toner\'' for v in c2018 if v[0] == 'tmall']
        c2018a_jd = ['\'{}\''.format(v[1]) for v in c2018 if v[0] == 'jd']
        c2018b_jd = ['\'{}\''.format(v[2]) for v in c2018 if v[0] == 'jd']
        c2018c_jd = ['\'Gel/toner\'' for v in c2018 if v[0] == 'jd']

        c2019a_ali = ['\'{}\''.format(v[1]) for v in c2019 if v[0] == 'tmall']
        c2019b_ali = ['\'{}\''.format(v[2]) for v in c2019 if v[0] == 'tmall']
        c2019c_ali = ['\'Gel/toner\'' for v in c2019 if v[0] == 'tmall']
        c2019a_jd = ['\'{}\''.format(v[1]) for v in c2019 if v[0] == 'jd']
        c2019b_jd = ['\'{}\''.format(v[2]) for v in c2019 if v[0] == 'jd']
        c2019c_jd = ['\'Gel/toner\'' for v in c2019 if v[0] == 'jd']

        c2020a_ali = ['\'{}\''.format(v[1]) for v in c2020 if v[0] == 'tmall']
        c2020b_ali = ['\'{}\''.format(v[2]) for v in c2020 if v[0] == 'tmall']
        c2020c_ali = ['\'Gel/toner\'' for v in c2020 if v[0] == 'tmall']
        c2020a_jd = ['\'{}\''.format(v[1]) for v in c2020 if v[0] == 'jd']
        c2020b_jd = ['\'{}\''.format(v[2]) for v in c2020 if v[0] == 'jd']
        c2020c_jd = ['\'Gel/toner\'' for v in c2020 if v[0] == 'jd']

        d2018a_ali = ['\'{}\''.format(v[1]) for v in d2018 if v[0] == 'tmall']
        d2018b_ali = ['\'{}\''.format(v[2]) for v in d2018 if v[0] == 'tmall']
        d2018c_ali = ['\'Essence/Ampoule\'' for v in d2018 if v[0] == 'tmall']
        d2018a_jd = ['\'{}\''.format(v[1]) for v in d2018 if v[0] == 'jd']
        d2018b_jd = ['\'{}\''.format(v[2]) for v in d2018 if v[0] == 'jd']
        d2018c_jd = ['\'Essence/Ampoule\'' for v in d2018 if v[0] == 'jd']

        d2019a_ali = ['\'{}\''.format(v[1]) for v in d2019 if v[0] == 'tmall']
        d2019b_ali = ['\'{}\''.format(v[2]) for v in d2019 if v[0] == 'tmall']
        d2019c_ali = ['\'Essence/Ampoule\'' for v in d2019 if v[0] == 'tmall']
        d2019a_jd = ['\'{}\''.format(v[1]) for v in d2019 if v[0] == 'jd']
        d2019b_jd = ['\'{}\''.format(v[2]) for v in d2019 if v[0] == 'jd']
        d2019c_jd = ['\'Essence/Ampoule\'' for v in d2019 if v[0] == 'jd']

        d2020a_ali = ['\'{}\''.format(v[1]) for v in d2020 if v[0] == 'tmall']
        d2020b_ali = ['\'{}\''.format(v[2]) for v in d2020 if v[0] == 'tmall']
        d2020c_ali = ['\'Essence/Ampoule\'' for v in d2020 if v[0] == 'tmall']
        d2020a_jd = ['\'{}\''.format(v[1]) for v in d2020 if v[0] == 'jd']
        d2020b_jd = ['\'{}\''.format(v[2]) for v in d2020 if v[0] == 'jd']
        d2020c_jd = ['\'Essence/Ampoule\'' for v in d2020 if v[0] == 'jd']

        sql = '''
            ALTER TABLE {} UPDATE
                `c_props.name` = arrayConcat(
                    arrayFilter((x) -> x NOT IN ['功效', 'Sub-category'], `c_props.name`),
                    ['功效', 'Sub-category']
                ),
                `c_props.value` = arrayConcat(
                    arrayFilter((k, x) -> x NOT IN ['功效', 'Sub-category'], `c_props.value`, `c_props.name`),
                    [
                        multiIf(
                            pkey >= '2021-01-01', '',
                            pkey >= '2020-01-01' and source = 1, transform(item_id, [{}], [{}], ''),
                            pkey >= '2019-01-01' and source = 1, transform(item_id, [{}], [{}], ''),
                            pkey >= '2018-01-01' and source = 1, transform(item_id, [{}], [{}], ''),
                            pkey >= '2020-01-01' and source = 2, transform(item_id, [{}], [{}], ''),
                            pkey >= '2019-01-01' and source = 2, transform(item_id, [{}], [{}], ''),
                            pkey >= '2018-01-01' and source = 2, transform(item_id, [{}], [{}], ''),
                            ''
                        ),
                        multiIf(
                            pkey >= '2021-01-01', `c_props.value`[indexOf(`c_props.name`, 'Sub-category')],
                            pkey >= '2020-01-01' and source = 1, transform(item_id, [{}], [{}], `c_props.value`[indexOf(`c_props.name`, 'Sub-category')]),
                            pkey >= '2019-01-01' and source = 1, transform(item_id, [{}], [{}], `c_props.value`[indexOf(`c_props.name`, 'Sub-category')]),
                            pkey >= '2018-01-01' and source = 1, transform(item_id, [{}], [{}], `c_props.value`[indexOf(`c_props.name`, 'Sub-category')]),
                            pkey >= '2020-01-01' and source = 2, transform(item_id, [{}], [{}], `c_props.value`[indexOf(`c_props.name`, 'Sub-category')]),
                            pkey >= '2019-01-01' and source = 2, transform(item_id, [{}], [{}], `c_props.value`[indexOf(`c_props.name`, 'Sub-category')]),
                            pkey >= '2018-01-01' and source = 2, transform(item_id, [{}], [{}], `c_props.value`[indexOf(`c_props.name`, 'Sub-category')]),
                            `c_props.value`[indexOf(`c_props.name`, 'Sub-category')]
                        )
                    ]
                )
            WHERE 1
        '''.format(tbl,
            ','.join(a2020a_ali+b2020a_ali+c2020a_ali+d2020a_ali), ','.join(a2020b_ali+b2020b_ali+c2020b_ali+d2020b_ali),
            ','.join(a2019a_ali+b2019a_ali+c2019a_ali+d2019a_ali), ','.join(a2019b_ali+b2019b_ali+c2019b_ali+d2019b_ali),
            ','.join(a2018a_ali+b2018a_ali+c2018a_ali+d2018a_ali), ','.join(a2018b_ali+b2018b_ali+c2018b_ali+d2018b_ali),
            ','.join(a2020a_jd+b2020a_jd+c2020a_jd+d2020a_jd), ','.join(a2020b_jd+b2020b_jd+c2020b_jd+d2020b_jd),
            ','.join(a2019a_jd+b2019a_jd+c2019a_jd+d2019a_jd), ','.join(a2019b_jd+b2019b_jd+c2019b_jd+d2019b_jd),
            ','.join(a2018a_jd+b2018a_jd+c2018a_jd+d2018a_jd), ','.join(a2018b_jd+b2018b_jd+c2018b_jd+d2018b_jd),
            ','.join(a2020a_ali+b2020a_ali+c2020a_ali+d2020a_ali), ','.join(a2020c_ali+b2020c_ali+c2020c_ali+d2020c_ali),
            ','.join(a2019a_ali+b2019a_ali+c2019a_ali+d2019a_ali), ','.join(a2019c_ali+b2019c_ali+c2019c_ali+d2019c_ali),
            ','.join(a2018a_ali+b2018a_ali+c2018a_ali+d2018a_ali), ','.join(a2018c_ali+b2018c_ali+c2018c_ali+d2018c_ali),
            ','.join(a2020a_jd+b2020a_jd+c2020a_jd+d2020a_jd), ','.join(a2020c_jd+b2020c_jd+c2020c_jd+d2020c_jd),
            ','.join(a2019a_jd+b2019a_jd+c2019a_jd+d2019a_jd), ','.join(a2019c_jd+b2019c_jd+c2019c_jd+d2019c_jd),
            ','.join(a2018a_jd+b2018a_jd+c2018a_jd+d2018a_jd), ','.join(a2018c_jd+b2018c_jd+c2018c_jd+d2018c_jd)
        )
        dba.execute(sql)

        while not self.cleaner.check_mutations_end(dba, tbl):
            time.sleep(5)